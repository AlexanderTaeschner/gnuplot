# Makefile.in for GNUPLOT documentation
#
# Note that the top-level file for documentation is gnuplot.doc.
# See README.
#
# To print manual:
#    make gnuplot.dvi             (for latex)
#    (print or view gnuplot.dvi)
# OR
#    make gnuplot.nroff           (for nroff)
#    (print or view gnuplot.nroff)
#   or
#    make "TROFF=itroff" troff    (for troff; use your troff here)
#

# default is what is needed for interactive gnuplot
default: gnuplot.hlp gnuplot.gih

# this tells GNU make not to export variables into the environment
# But other makes dont understand its significance, so it must
# not be the first target in the file. So it is here, before
# any variables are created, but after the default target
.NOEXPORT:

SHELL = /bin/sh

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
datadir = @datadir@
mandir = @mandir@
srcdir = @srcdir@
top_builddir = .
top_srcdir = @top_srcdir@
VPATH = @srcdir@

INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@

CC     = @CC@
DEFS   = @DEFS@
CFLAGS = @CFLAGS@
INCLUDES = -I.. -I$(srcdir)/.. -I$(srcdir)/../term -I.
LDFLAGS = @LDFLAGS@
LIBS = 

COMPILE = $(CC) $(DEFS) $(INCLUDES) $(CFLAGS)
LINK = $(CC) $(CFLAGS) $(LDFLAGS) -o $@

# The makeinfo command from GNU texinfo
MAKEINFO = makeinfo

# substitute your troff command (and any flags) for this one
TROFF=troff

# substitute your DVI to PostScript conversion program here
DVIPS=dvips

# list of terminals, generated at configure time
TERM_LIST = \@TERM_LIST@

allterm.h : $(TERM_LIST)
	@echo Building allterm.h
	cat $(srcdir)/../term/*.trm > allterm.h

# for debugging
alldoc: check dvi gih hlp html info ipf ms nroff ps rnh rtf

### [tn]roff documentation
troff: gnuplot.ms titlepag.ms
	@if [ "$(srcdir)" = "$(top_builddir)" ] ; then \
	    tbl gnuplot.ms | eqn | $(TROFF) -ms ; \
	else \
	    < gnuplot.ms sed "s,titlepag\.ms,$(srcdir)/titlepag\.ms," |\
	      tbl | eqn | $(TROFF) -ms ; \
	fi

nroff: gnuplot.nroff

gnuplot.nroff: gnuplot.ms titlepag.ms
	@if [ "$(srcdir)" = "$(top_builddir)" ] ; then \
	    tbl gnuplot.ms | neqn | nroff -ms | col > gnuplot.nroff ; \
	else \
	    < gnuplot.ms sed "s,titlepag\.ms,$(srcdir)/titlepag\.ms," |\
	      tbl | neqn | nroff -ms | col > gnuplot.nroff ; \
	fi

### doc2xxx dependencies
ms: gnuplot.ms

gnuplot.ms: doc2ms $(srcdir)/gnuplot.doc
	./doc2ms $(srcdir)/gnuplot.doc gnuplot.ms

doc2ms: doc2ms.o termdoc.o
	$(LINK) doc2ms.o termdoc.o $(LIBS)

doc2ms.o: doc2ms.c allterm.h
	$(COMPILE) -DALL_TERM_DOC -c doc2ms.c

### html
html : gnuplot.html

gnuplot.html : doc2html $(srcdir)/gnuplot.doc
	./doc2html $(srcdir)/gnuplot.doc gnuplot.html

doc2html : doc2html.o termdoc.o xref.o
	$(LINK) doc2html.o termdoc.o xref.o $(LDFLAGS) $(LIBS)

doc2html.o: doc2html.c allterm.h
	$(COMPILE) -DALL_TERM_DOC -c doc2html.c

### LaTeX documentation
tex: gnuplot.tex

gnuplot.tex: doc2tex $(srcdir)/gnuplot.doc
	./doc2tex $(srcdir)/gnuplot.doc gnuplot.tex

doc2tex: doc2tex.o termdoc.o
	$(LINK) doc2tex.o termdoc.o $(LIBS)

doc2tex.o: doc2tex.c allterm.h
	$(COMPILE) -DALL_TERM_DOC -c doc2tex.c

# this is how to make DVI files
dvi: gnuplot.dvi gpcard.dvi

gnuplot.dvi: gnuplot.tex titlepag.tex toc_entr.sty
	TEXINPUTS=.:$(srcdir): latex gnuplot
	TEXINPUTS=.:$(srcdir): latex gnuplot

gpcard.dvi: gpcard.tex
	TEXINPUTS=.:$(srcdir): tex gpcard

# this is how to make PostScript files
# if pslatex has been installed, add "times" to titlepage.tex
ps: gnuplot.ps gpcard.ps

gnuplot.ps: gnuplot.dvi
	$(DVIPS) gnuplot.dvi -o gnuplot.ps

gpcard.ps: gpcard.dvi
	$(DVIPS) gpcard.dvi -o gpcard.ps


# this is how to make gnuplot.hlp
hlp: gnuplot.hlp

gnuplot.hlp: doc2hlp $(srcdir)/gnuplot.doc
	./doc2hlp $(srcdir)/gnuplot.doc gnuplot.hlp

doc2hlp: doc2hlp.o termdoc.o
	$(LINK) doc2hlp.o termdoc.o $(LIBS)

# this is how to make gnuplot.gih
gih: gnuplot.gih

gnuplot.gih: doc2gih $(srcdir)/gnuplot.doc
	./doc2gih $(srcdir)/gnuplot.doc gnuplot.gih

doc2gih: doc2gih.o termdoc.o
	$(LINK) doc2gih.o termdoc.o $(LIBS)

# To include all terminals in the .gih file
allgih: doc2gih.c allterm.h
	$(COMPILE) -DALL_TERM_DOC -c doc2gih.c
	$(MAKE) gih

# this is how to make Info documentation
info: gnuplot.info

gnuplot.info: doc2info $(srcdir)/gnuplot.doc
	./doc2info $(srcdir)/gnuplot.doc gnuplot.info

doc2info: doc2info.o termdoc.o xref.o
	$(LINK) doc2info.o termdoc.o xref.o $(LIBS)

# this is how to make OS/2 ipfc documentation
ipf: gnuplot.ipf

gnuplot.ipf: doc2ipf $(srcdir)/gnuplot.doc
	./doc2ipf $(srcdir)/gnuplot.doc gnuplot.ipf

doc2ipf: doc2ipf.o termdoc.o xref.o
	$(LINK) doc2ipf.o termdoc.o xref.o $(LIBS)

# this is how to make rtf documentation
rtf: gnuplot.rtf

gnuplot.rtf: doc2rtf $(srcdir)/gnuplot.doc
	./doc2rtf $(srcdir)/gnuplot.doc gnuplot.rtf

doc2rtf: doc2rtf.o termdoc.o xref.o
	$(LINK) doc2rtf.o termdoc.o xref.o $(LIBS)

# this is how to make rnh documentation (VMS help format)
rnh: gnuplot.rnh

gnuplot.rnh: doc2rnh $(srcdir)/gnuplot.doc
	./doc2rnh $(srcdir)/gnuplot.doc gnuplot.rnh

doc2rnh: doc2rnh.o termdoc.o
	$(LINK) doc2rnh.o termdoc.o $(LIBS)

# end doc2xxx section

tutorial: latextut/tutorial.tex
	( cd latextut; $(MAKE) )

# this is how to check the gnuplot.doc file
check: checkdoc $(srcdir)/gnuplot.doc
	./checkdoc < $(srcdir)/gnuplot.doc

checkdoc: checkdoc.o termdoc.o
	$(LINK) checkdoc.o termdoc.o $(LIBS)

checkdoc.o: checkdoc.c allterm.h
	$(COMPILE) -DALL_TERM_DOC -c checkdoc.c

# For Unix and MSDOS only
install: gnuplot.gih
	$(INSTALL_DATA) gnuplot.gih $(datadir)/gnuplot.gih

uninstall:
	rm -f $(datadir)/gnuplot.gih

# for VMS only
install-vms: gnuplot.hlp
	$(INSTALL_DATA) gnuplot.hlp $(datadir)/gnuplot.hlp

clean:
	rm -f doc2tex gnuplot.tex gnuplot.dvi \
	  gnuplot.aux gnuplot.log gnuplot.toc \
	  gnuplot.ps gpcard.dvi gpcard.log gpcard.ps \
	  doc2gih gnuplot.gih \
	  doc2hlp gnuplot.hlp \
	  doc2html gnuplot.html \
	  doc2info gnuplot.info* gpltinfo.tex \
	  doc2ipf gnuplot.ipf \
	  doc2ms gnuplot.ms \
	  doc2rnh gnuplot.rnh \
	  doc2rtf gnuplot.rtf \
	  gnuplot.nroff checkdoc *.o core a.out allterm.h
	( cd latextut; $(MAKE) clean )

mostlyclean: clean

distclean: clean
	rm -f Makefile

realclean: distclean
	rm -f TAGS

.c.o:
	$(COMPILE) -c $<

### Dependencies - do not edit!

# all doc2somethings depend on termdoc and either ../term.h or
# allterm.h, maybe this would be better as separate object file
# (but then we have to change all the other makefiles). Plus then
# we cannot make some doc2* filters use allterm.h and others use term.h

TERM_H = $(srcdir)/../term.h

checkdoc.o: checkdoc.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h allterm.h
doc2gih.o: doc2gih.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h $(TERM_H)
doc2hlp.o: doc2hlp.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h $(TERM_H)
doc2html.o: doc2html.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h allterm.h
doc2info.o: doc2info.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h $(TERM_H)
doc2ipf.o: doc2ipf.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h $(TERM_H)
doc2ms.o: doc2ms.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h allterm.h
doc2rnh.o: doc2rnh.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h $(TERM_H)
doc2rtf.o: doc2rtf.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h $(TERM_H)
doc2tex.o: doc2tex.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h allterm.h
termdoc.o: termdoc.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h
xref.o: xref.c ../config.h $(srcdir)/../ansichek.h \
		$(srcdir)/../stdfn.h doc2x.h xref.h

#the end
